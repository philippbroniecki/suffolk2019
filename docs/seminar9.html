<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Regression | Suffolk 2019</title>
  <meta name="description" content="Chapter 9 Regression | Suffolk 2019" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Regression | Suffolk 2019" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Regression | Suffolk 2019" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="seminar8.html">
<link rel="next" href="seminar10.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="lib/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="js/codefolding.js"></script>


<script>
$(document).ready(function () {
  window.initializeCodeFolding();
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib\bootstrap\3.3.7\css\bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="css\readthedocs.css" type="text/css" />
<link rel="stylesheet" href="css\custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this course</a></li>
<li class="chapter" data-level="1" data-path="seminar1.html"><a href="seminar1.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="seminar1.html"><a href="seminar1.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a><ul>
<li class="chapter" data-level="1.1.1" data-path="seminar1.html"><a href="seminar1.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="seminar1.html"><a href="seminar1.html#rstudio"><i class="fa fa-check"></i><b>1.1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="seminar1.html"><a href="seminar1.html#console"><i class="fa fa-check"></i><b>1.1.3</b> Console</a></li>
<li class="chapter" data-level="1.1.4" data-path="seminar1.html"><a href="seminar1.html#scripts"><i class="fa fa-check"></i><b>1.1.4</b> Scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="seminar2.html"><a href="seminar2.html"><i class="fa fa-check"></i><b>2</b> R-syntax, data structures and types</a><ul>
<li class="chapter" data-level="2.1" data-path="seminar2.html"><a href="seminar2.html#seminar"><i class="fa fa-check"></i><b>2.1</b> Seminar</a><ul>
<li class="chapter" data-level="2.1.1" data-path="seminar2.html"><a href="seminar2.html#functions"><i class="fa fa-check"></i><b>2.1.1</b> Functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="seminar2.html"><a href="seminar2.html#getting-help"><i class="fa fa-check"></i><b>2.1.2</b> Getting Help</a></li>
<li class="chapter" data-level="2.1.3" data-path="seminar2.html"><a href="seminar2.html#the-assignment-operator"><i class="fa fa-check"></i><b>2.1.3</b> The Assignment Operator</a></li>
<li class="chapter" data-level="2.1.4" data-path="seminar2.html"><a href="seminar2.html#vectors-and-subsetting"><i class="fa fa-check"></i><b>2.1.4</b> Vectors and subsetting</a></li>
<li class="chapter" data-level="2.1.5" data-path="seminar2.html"><a href="seminar2.html#matrices"><i class="fa fa-check"></i><b>2.1.5</b> Matrices</a></li>
<li class="chapter" data-level="2.1.6" data-path="seminar2.html"><a href="seminar2.html#arrays"><i class="fa fa-check"></i><b>2.1.6</b> Arrays</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="seminar3.html"><a href="seminar3.html"><i class="fa fa-check"></i><b>3</b> Data import (from csv, txt, and excel)</a><ul>
<li class="chapter" data-level="3.1" data-path="seminar3.html"><a href="seminar3.html#seminar-1"><i class="fa fa-check"></i><b>3.1</b> Seminar</a><ul>
<li class="chapter" data-level="3.1.1" data-path="seminar3.html"><a href="seminar3.html#setting-up"><i class="fa fa-check"></i><b>3.1.1</b> Setting up</a></li>
<li class="chapter" data-level="3.1.2" data-path="seminar3.html"><a href="seminar3.html#loading-data"><i class="fa fa-check"></i><b>3.1.2</b> Loading data</a></li>
<li class="chapter" data-level="3.1.3" data-path="seminar3.html"><a href="seminar3.html#importing-a-dataset-in-.csv-format"><i class="fa fa-check"></i><b>3.1.3</b> Importing a dataset in <code>.csv</code> format</a></li>
<li class="chapter" data-level="3.1.4" data-path="seminar3.html"><a href="seminar3.html#importing-a-dataset-in-excel-xlsx-format"><i class="fa fa-check"></i><b>3.1.4</b> Importing a dataset in Excel (xlsx) format</a></li>
<li class="chapter" data-level="3.1.5" data-path="seminar3.html"><a href="seminar3.html#importing-a-dataset-in-rdata-format"><i class="fa fa-check"></i><b>3.1.5</b> Importing a dataset in RData format</a></li>
<li class="chapter" data-level="3.1.6" data-path="seminar3.html"><a href="seminar3.html#importing-a-dataset-in-.txt-format."><i class="fa fa-check"></i><b>3.1.6</b> Importing a dataset in .txt format.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="seminar4.html"><a href="seminar4.html"><i class="fa fa-check"></i><b>4</b> Creating, amending, exporting data frames</a><ul>
<li class="chapter" data-level="4.1" data-path="seminar4.html"><a href="seminar4.html#seminar-2"><i class="fa fa-check"></i><b>4.1</b> Seminar</a><ul>
<li class="chapter" data-level="4.1.1" data-path="seminar4.html"><a href="seminar4.html#creating-data-frames"><i class="fa fa-check"></i><b>4.1.1</b> Creating data frames</a></li>
<li class="chapter" data-level="4.1.2" data-path="seminar4.html"><a href="seminar4.html#working-with-data-frames"><i class="fa fa-check"></i><b>4.1.2</b> Working with data frames</a></li>
<li class="chapter" data-level="4.1.3" data-path="seminar4.html"><a href="seminar4.html#amending-data-frames"><i class="fa fa-check"></i><b>4.1.3</b> Amending data frames</a></li>
<li class="chapter" data-level="4.1.4" data-path="seminar4.html"><a href="seminar4.html#saving-data-frames"><i class="fa fa-check"></i><b>4.1.4</b> Saving data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="seminar5.html"><a href="seminar5.html"><i class="fa fa-check"></i><b>5</b> Type coercion</a><ul>
<li class="chapter" data-level="5.1" data-path="seminar5.html"><a href="seminar5.html#seminar-3"><i class="fa fa-check"></i><b>5.1</b> Seminar</a><ul>
<li class="chapter" data-level="5.1.1" data-path="seminar5.html"><a href="seminar5.html#coerce-a-factor-to-character"><i class="fa fa-check"></i><b>5.1.1</b> Coerce a factor to character</a></li>
<li class="chapter" data-level="5.1.2" data-path="seminar5.html"><a href="seminar5.html#coerce-a-character-variable-into-a-factor-variable"><i class="fa fa-check"></i><b>5.1.2</b> Coerce a character variable into a factor variable</a></li>
<li class="chapter" data-level="5.1.3" data-path="seminar5.html"><a href="seminar5.html#coerce-a-character-variable-into-a-numeric-variable"><i class="fa fa-check"></i><b>5.1.3</b> Coerce a character variable into a numeric variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="seminar6.html"><a href="seminar6.html"><i class="fa fa-check"></i><b>6</b> Loops and conditions</a><ul>
<li class="chapter" data-level="6.1" data-path="seminar6.html"><a href="seminar6.html#seminar-4"><i class="fa fa-check"></i><b>6.1</b> Seminar</a><ul>
<li class="chapter" data-level="6.1.1" data-path="seminar6.html"><a href="seminar6.html#for-loops"><i class="fa fa-check"></i><b>6.1.1</b> For loops</a></li>
<li class="chapter" data-level="6.1.2" data-path="seminar6.html"><a href="seminar6.html#conditions"><i class="fa fa-check"></i><b>6.1.2</b> Conditions</a></li>
<li class="chapter" data-level="6.1.3" data-path="seminar6.html"><a href="seminar6.html#the-ifelse-function"><i class="fa fa-check"></i><b>6.1.3</b> The ifelse() function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="seminar7.html"><a href="seminar7.html"><i class="fa fa-check"></i><b>7</b> Visualising data</a><ul>
<li class="chapter" data-level="7.1" data-path="seminar7.html"><a href="seminar7.html#seminar-5"><i class="fa fa-check"></i><b>7.1</b> Seminar</a><ul>
<li class="chapter" data-level="7.1.1" data-path="seminar7.html"><a href="seminar7.html#plots"><i class="fa fa-check"></i><b>7.1.1</b> Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="seminar8.html"><a href="seminar8.html"><i class="fa fa-check"></i><b>8</b> Correlations and differences in means</a><ul>
<li class="chapter" data-level="8.1" data-path="seminar8.html"><a href="seminar8.html#seminar-6"><i class="fa fa-check"></i><b>8.1</b> Seminar</a><ul>
<li class="chapter" data-level="8.1.1" data-path="seminar8.html"><a href="seminar8.html#sample-variance-and-sample-standard-deviation"><i class="fa fa-check"></i><b>8.1.1</b> Sample Variance and Sample Standard Deviation</a></li>
<li class="chapter" data-level="8.1.2" data-path="seminar8.html"><a href="seminar8.html#t-test-for-the-sample-mean"><i class="fa fa-check"></i><b>8.1.2</b> T test for the sample mean</a></li>
<li class="chapter" data-level="8.1.3" data-path="seminar8.html"><a href="seminar8.html#loading-real-data"><i class="fa fa-check"></i><b>8.1.3</b> Loading real data</a></li>
<li class="chapter" data-level="8.1.4" data-path="seminar8.html"><a href="seminar8.html#t-test-one-sample-hypothesis-test-with-real-data"><i class="fa fa-check"></i><b>8.1.4</b> T-test (one-sample hypothesis test) with real data</a></li>
<li class="chapter" data-level="8.1.5" data-path="seminar8.html"><a href="seminar8.html#t-test-difference-in-means"><i class="fa fa-check"></i><b>8.1.5</b> T-test (difference in means)</a></li>
<li class="chapter" data-level="8.1.6" data-path="seminar8.html"><a href="seminar8.html#relationships-between-continuous-variables"><i class="fa fa-check"></i><b>8.1.6</b> Relationships between continuous variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="seminar9.html"><a href="seminar9.html"><i class="fa fa-check"></i><b>9</b> Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="seminar9.html"><a href="seminar9.html#seminar-7"><i class="fa fa-check"></i><b>9.1</b> Seminar</a><ul>
<li class="chapter" data-level="9.1.1" data-path="seminar9.html"><a href="seminar9.html#interpreting-regression-output"><i class="fa fa-check"></i><b>9.1.1</b> Interpreting Regression Output</a></li>
<li class="chapter" data-level="9.1.2" data-path="seminar9.html"><a href="seminar9.html#fitted-values"><i class="fa fa-check"></i><b>9.1.2</b> Fitted values</a></li>
<li class="chapter" data-level="9.1.3" data-path="seminar9.html"><a href="seminar9.html#additional-resources"><i class="fa fa-check"></i><b>9.1.3</b> Additional Resources</a></li>
<li class="chapter" data-level="9.1.4" data-path="seminar9.html"><a href="seminar9.html#multiple-linear-regression-models"><i class="fa fa-check"></i><b>9.1.4</b> Multiple linear regression models</a></li>
<li class="chapter" data-level="9.1.5" data-path="seminar9.html"><a href="seminar9.html#estimating-a-bivariate-regression"><i class="fa fa-check"></i><b>9.1.5</b> Estimating a Bivariate Regression</a></li>
<li class="chapter" data-level="9.1.6" data-path="seminar9.html"><a href="seminar9.html#non-linearities"><i class="fa fa-check"></i><b>9.1.6</b> Non-Linearities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="seminar10.html"><a href="seminar10.html"><i class="fa fa-check"></i><b>10</b> Prediction and assessing prediction accuracy</a><ul>
<li class="chapter" data-level="10.1" data-path="seminar10.html"><a href="seminar10.html#seminar-8"><i class="fa fa-check"></i><b>10.1</b> Seminar</a><ul>
<li class="chapter" data-level="10.1.1" data-path="seminar10.html"><a href="seminar10.html#model-the-underlying-continuous-process"><i class="fa fa-check"></i><b>10.1.1</b> Model the Underlying Continuous Process</a></li>
<li class="chapter" data-level="10.1.2" data-path="seminar10.html"><a href="seminar10.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>10.1.2</b> Leave-One-Out-Cross-Validation</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Suffolk 2019</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Regression</h1>
<div id="seminar-7" class="section level2">
<h2><span class="header-section-number">9.1</span> Seminar</h2>
<p>In this section, we will cover regression models. We will first introduce the bivariate linear regression model. We will then move to linear models with multiple independent variables. Next, we discuss counfounders as threats to our inference. Finally, we will introduce the logistic regression model.</p>
<p>First, however, we install a new pacakge called <code>texreg</code> which makes it easy to produce publication quality output from our regression models. We’ll discuss this package in more detail as we go along. For now let’s install the package with the <code>install.packages("texreg")</code> function and then load it using <code>library(texreg)</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;texreg&quot;</span>)
<span class="kw">library</span>(texreg)</code></pre>
<p>We will use a dataset collected by the US census bureau that contains several socioeconomic indicators.</p>
<pre class="sourceCode r"><code class="sourceCode r">communities &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;communities.csv&quot;</span>)</code></pre>
<p>The dataset includes 38 variables but we’re only interested in a handful at the moment.</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PctUnemployed</td>
<td align="left">proportion of citizens in each community who are unemployed</td>
</tr>
<tr class="even">
<td align="left">PctNotHSGrad</td>
<td align="left">proportion of citizens in each community who failed to finish high-school</td>
</tr>
<tr class="odd">
<td align="left">population</td>
<td align="left">proportion of adult population living in cities</td>
</tr>
</tbody>
</table>
<pre><code>  PctUnemployed PctNotHSGrad population
1          0.27         0.18       0.19
2          0.27         0.24       0.00
3          0.36         0.43       0.00
4          0.33         0.25       0.04
5          0.12         0.30       0.01
6          0.10         0.12       0.02</code></pre>
<p>If we summarize these variables with the <code>summary()</code> function, we will see that they are both measured as proportions (they vary between 0 and 1):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(communities<span class="op">$</span>PctUnemployed)</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.2200  0.3200  0.3635  0.4800  1.0000 </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(communities<span class="op">$</span>PctNotHSGrad)</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.2300  0.3600  0.3833  0.5100  1.0000 </code></pre>
<p>It will be a little easier to interpret the regression output if we convert these to percentages rather than proportions. We can do this with the following lines of code:</p>
<pre class="sourceCode r"><code class="sourceCode r">communities<span class="op">$</span>PctUnemployed &lt;-<span class="st"> </span>communities<span class="op">$</span>PctUnemployed <span class="op">*</span><span class="st"> </span><span class="dv">100</span>
communities<span class="op">$</span>PctNotHSGrad &lt;-<span class="st"> </span>communities<span class="op">$</span>PctNotHSGrad <span class="op">*</span><span class="st"> </span><span class="dv">100</span></code></pre>
<p>We can begin by drawing a scatterplot with the percentage of unemployed people on the y-axis and the percentage of adults without high-school education on the x-axis.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> communities<span class="op">$</span>PctNotHSGrad,
  <span class="dt">y =</span> communities<span class="op">$</span>PctUnemployed,
  <span class="dt">xlab =</span> <span class="st">&quot;Adults without high school education (%)&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Unemployment (%)&quot;</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">col =</span> <span class="st">&quot;LightSkyBlue&quot;</span>
)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>From looking at the plot, what is the association between the unemployment rate and lack of high-school level education?</p>
<p>In order to answer that question empirically, we will run a linear regression using the <a href="http://bit.ly/R_lm"><code>lm()</code></a> function in R. The <a href="http://bit.ly/R_lm"><code>lm()</code></a> function needs to know a) the relationship we’re trying to model and b) the dataset for our observations. The two arguments we need to provide to the <a href="http://bit.ly/R_lm"><code>lm()</code></a> function are described below.</p>
<table>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>formula</code></td>
<td>The <code>formula</code> describes the relationship between the dependent and independent variables, for example <code>dependent.variable ~ independent.variable</code> <br> In our case, we’d like to model the relationship using the formula: <code>PctUnemployed ~ PctNotHSGrad</code></td>
</tr>
<tr class="even">
<td><code>data</code></td>
<td>This is simply the name of the dataset that contains the variable of interest. In our case, this is the merged dataset called <code>communities</code>.</td>
</tr>
</tbody>
</table>
<p>For more information on how the <code>lm()</code> function works, type help(lm) in R.</p>
<pre class="sourceCode r"><code class="sourceCode r">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(PctUnemployed <span class="op">~</span><span class="st"> </span>PctNotHSGrad, <span class="dt">data =</span> communities)</code></pre>
<div id="interpreting-regression-output" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Interpreting Regression Output</h3>
<p>The <a href="http://bit.ly/R_lm"><code>lm()</code></a> function has modeled the relationship between <code>PctUnemployed</code> and <code>PctNotHSGrad</code> and we’ve saved it in an object called <code>model1</code>. Let’s use the <a href="http://bit.ly/R_summary"><code>summary()</code></a> function to see what this linear model looks like.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model1)</code></pre>
<p>The output from <a href="http://bit.ly/R_summary"><code>summary()</code></a> might seem overwhelming at first so let’s break it down one item at a time.</p>
<p><img src="img/lm-annotated-1.png" width="700" /></p>
<table>
<colgroup>
<col width="7%" />
<col width="23%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1</strong></td>
<td><em>formula</em></td>
<td>The <em>formula</em> describes the relationship between the dependent and independent variables</td>
</tr>
<tr class="even">
<td><strong>2</strong></td>
<td><em>residuals</em></td>
<td>The differences between the observed values and the predicted values are called <em>residuals</em>.</td>
</tr>
<tr class="odd">
<td><strong>3</strong></td>
<td><em>coefficients</em></td>
<td>The <em>coefficients</em> for all the <em>independent</em> variables and the intercept. Using the <em>coefficients</em> we can write down the relationship between the <em>dependent</em> and the <em>independent</em> variables as: <br><br><code>PctUnemployed</code> = 7.8952023 + ( 0.7423853 * <code>PctNotHSGrad</code> ) <br><br>This tells us that for each unit increase in the variable <code>PctNotHSGrad</code>, the <code>PctUnemployed</code> increases by 0.7423853.</td>
</tr>
<tr class="even">
<td><strong>4</strong></td>
<td><em>standard error</em></td>
<td>The <em>standard error</em> estimates the standard deviation of the sampling distribution of the coefficients in our model. We can think of the <em>standard error</em> as the measure of precision for the estimated coefficients.</td>
</tr>
<tr class="odd">
<td><strong>5</strong></td>
<td><em>t-statistic</em></td>
<td>The <em>t-statistic</em> is obtained by dividing the <em>coefficients</em> by the <em>standard error</em>.</td>
</tr>
<tr class="even">
<td><strong>6</strong></td>
<td><em>p-value</em></td>
<td>The <em>p-value</em> for each of the coefficients in the model. Recall that according to the null hypotheses, the value of the coefficient of interest is zero. The <em>p-value</em> tells us whether can can reject the null hypotheses or not.</td>
</tr>
<tr class="odd">
<td><strong>7</strong></td>
<td><span class="math inline">\(R^2\)</span> and <em>adj-<span class="math inline">\(R^2\)</span></em></td>
<td>tell us how much of the variance in our model is accounted for by the <em>independent</em> variable. The <em>adjusted <span class="math inline">\(R^2\)</span></em> is always smaller than <em><span class="math inline">\(R^2\)</span></em> as it takes into account the number of <em>independent</em> variables and degrees of freedom.</td>
</tr>
</tbody>
</table>
<p>Now let’s add a regression line to the scatter plot using the <a href="http://bit.ly/R_abline"><code>abline()</code></a> function.</p>
<p>First we run the same <a href="http://bit.ly/R_plot"><code>plot()</code></a> function as before, then we overlay a line with <a href="http://bit.ly/R_abline"><code>abline()</code></a>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> communities<span class="op">$</span>PctNotHSGrad,
  <span class="dt">y =</span> communities<span class="op">$</span>PctUnemployed,
  <span class="dt">xlab =</span> <span class="st">&quot;Adults without high school education (%)&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Unemployment (%)&quot;</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">col =</span> <span class="st">&quot;LightSkyBlue&quot;</span>
)

<span class="kw">abline</span>(model1, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>We can see by looking at the regression line that it matches the coefficients we estimated above. For example, when <code>PctNotHSGrad</code> is equal to zero (i.e. where the line intersects the Y-axis), the predicted value for <code>PctUnemployed</code> seems to be above 0 but below 10. This is good, as the <em>intercept</em> coefficient we estimated in the regression was 7.8952023.</p>
<p>Similarly, the coefficient for the variable <code>PctNotHSGrad</code> was estimated to be 0.7423853, which implies that a one point increase in the percentage of citizens with no high-school education is associated with about 0.7423853 of a point increase in the percentage of citizens who are unemployed. The line in the plot seems to reflect this: it is upward sloping, so that higher levels of the no high-school variable are associated with higher levels of unemployment, but the relationship is not quite 1-to-1. That is, for each additional percentage point of citzens without high school education, the percentage of citizens who are unemployed increases by a little less than one point.</p>
<p>While the <a href="http://bit.ly/R_summary"><code>summary()</code></a> function provides a slew of information about a fitted regression model, we often need to present our findings in easy to read tables similar to what you see in journal publications. The <code>texreg</code> package we loaded earlier allows us to do just that.</p>
<p>Let’s take a look at how to display the output of a regression model on the screen using the <a href="http://bit.ly/R_texreg"><code>screenreg()</code></a> function from <code>texreg</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(model1)</code></pre>
<pre><code>
=========================
              Model 1    
-------------------------
(Intercept)      7.90 ***
                (0.65)   
PctNotHSGrad     0.74 ***
                (0.01)   
-------------------------
R^2              0.55    
Adj. R^2         0.55    
Num. obs.     1994       
RMSE            13.52    
=========================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>Here, the output includes some of the most salient details we need for interpretation. We can see the coefficient for the <code>PctNotHSGrad</code> variable, and the estimated coefficient for the intercept. Below these numbers, in brackets, we can see the standard errors. The table also reports the <span class="math inline">\(R^2\)</span>, the adjusted <span class="math inline">\(R^2\)</span>, the number of observations (<span class="math inline">\(n\)</span>) and the root-mean-squared-error (<span class="math inline">\(RMSE\)</span>).</p>
<p>One thing to note is that the table does not include either t-statistics or p-values for the estimated coefficents. Instead, the table employs a common device of using stars to denote whether a variable is statistically significant at a given alpha level.</p>
<ul>
<li><code>***</code> indicates that the coefficient is significant at the 99.9% confidence level (alpha = 0.001)</li>
<li><code>**</code> indicates that the coefficient is significant at the 99% confidence level (alpha = 0.01)</li>
<li><code>*</code> indicates that the coefficient is significant at the 95% confidence level (alpha = 0.05)</li>
</ul>
<p>Returning to our example, are there other variables that might affect the unemployment rate in our dataset? For example, is the unemployment rate higher in rural areas? To answer this question, we can swap <code>PctNotHSGrad</code> for a different independent variable. Let’s use the variable <code>population</code>, which measures the proportion of adults who live in cities (rather than rural areas). Again, we can transform this proportion to a percentage with the following code:</p>
<pre class="sourceCode r"><code class="sourceCode r">communities<span class="op">$</span>population &lt;-<span class="st"> </span>communities<span class="op">$</span>population <span class="op">*</span><span class="st"> </span><span class="dv">100</span></code></pre>
<p>Let’s fit a linear model using <code>population</code> as the independent variable:</p>
<pre class="sourceCode r"><code class="sourceCode r">model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(PctUnemployed <span class="op">~</span><span class="st"> </span>population, <span class="dt">data =</span> communities)
<span class="kw">summary</span>(model2)</code></pre>
<pre><code>
Call:
lm(formula = PctUnemployed ~ population, data = communities)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.252 -14.715  -3.946  11.054  64.980 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 35.02042    0.49206  71.171  &lt; 2e-16 ***
population   0.23139    0.03532   6.552  7.2e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 20.01 on 1992 degrees of freedom
Multiple R-squared:  0.0211,    Adjusted R-squared:  0.02061 
F-statistic: 42.93 on 1 and 1992 DF,  p-value: 7.201e-11</code></pre>
<p>We can show regression line from the <code>model2</code> just like we did with our first model.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> communities<span class="op">$</span>population,
  <span class="dt">y =</span> communities<span class="op">$</span>PctUnemployed,
  <span class="dt">xlab =</span> <span class="st">&quot;Adults living in cities (%)&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Unemployment (%)&quot;</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">col =</span> <span class="st">&quot;LightSkyBlue&quot;</span>
)

<span class="kw">abline</span>(model2, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<p>So we now have two models! Often, we will want to compare two estimated models side-by-side. We might want to say how the coefficients for the independent variables we included differ in <code>model1</code> and <code>model2</code>, for example. Or we may want to ask: Does <code>model2</code> offer a better fit than <code>model1</code>?</p>
<p>It is often useful to print the salient details from the estimated models side-by-side. We can do this by using the <a href="http://bit.ly/R_texreg"><code>screenreg()</code></a> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(<span class="kw">list</span>(model1, model2))</code></pre>
<pre><code>
======================================
              Model 1      Model 2    
--------------------------------------
(Intercept)      7.90 ***    35.02 ***
                (0.65)       (0.49)   
PctNotHSGrad     0.74 ***             
                (0.01)                
population                    0.23 ***
                             (0.04)   
--------------------------------------
R^2              0.55         0.02    
Adj. R^2         0.55         0.02    
Num. obs.     1994         1994       
RMSE            13.52        20.01    
======================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>What does this table tell us?</p>
<ul>
<li>The first column replicates the results from our first model. We can see that a one point increase in the percentage of citizens without high-school education is associated with an increase of 0.7423853 percentage points of unemployment, on average.</li>
<li>The second column gives us the results from the second model. Here, a one point increase in the percentage of citizens who live in cities is associated with an increase of 0.2313906 percentage points of unemployment, on average</li>
<li>We can also compare the <span class="math inline">\(R^2\)</span> values from the two models. The <span class="math inline">\(R^2\)</span> for <code>model1</code> is 0.5529732 and for <code>model2</code> is 0.0210968. This suggests that the model with <code>PctNotHSGrad</code> as the explanatory variable explains about 55.2973193% of the variation in unemployment. The model with <code>population</code> as the explanatory variable, on the other hand, explains just 2.1096753% of the variation in unemployment.</li>
</ul>
<p>Finally, and this is something that might help with your coursework, let’s save the same output as a Microsoft Word document using <a href="http://bit.ly/R_texreg"><code>htmlreg()</code></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">htmlreg</span>(<span class="kw">list</span>(model1, model2), <span class="dt">file =</span> <span class="st">&quot;regression_model.doc&quot;</span>)</code></pre>
<p>If you’re using a Mac, you might want to save the file as <code>.html</code> if the Word document isn’t formatted correctly.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">htmlreg</span>(<span class="kw">list</span>(model1, model2), <span class="dt">file =</span> <span class="st">&quot;regression_model.html&quot;</span>)</code></pre>
</div>
<div id="fitted-values" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Fitted values</h3>
<p>Once we have estimated a regression model, we can use that model to produce fitted values. Fitted values represent our “best guess” for the value of our dependent variable for a specific value of our independent variable.</p>
<p>Let’s calculate the fitted values manually and then we’ll show you how to do it in R. The fitted value formula is:</p>
<p><span class="math display">\[\hat{Y}_{i} = \hat{\beta}_0 + \hat{\beta}_1 * X_i\]</span></p>
<p>Let’s say that, on the basis of <code>model1</code> we would like to know what the unemployment rate is likely to be for a community where the percentage of adults without a high-school education is equal to 10%. We can substitute in the relevant coefficients from <code>model1</code> and the value for our X variable (<code>10</code> in this case), and we get:</p>
<p><span class="math display">\[\hat{Y}_{i} = 7.9 + 0.74 * 10 = 15.3\]</span></p>
<p>To calculate fitted values in R, we use the <code>predict()</code> function.</p>
<p>The predict function takes two main arguments.</p>
<table>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>object</code></td>
<td>The <code>object</code> is the model object that we would like to use to produce fitted values. Here, we would like to base the analysis on <code>model1</code> and so specify <code>object = model1</code> here.</td>
</tr>
<tr class="even">
<td><code>newdata</code></td>
<td>This is an optional argument which we use to specify the values of our independent variable(s) that we would like fitted values for. If we leave this argument empty, R will automatically calculate fitted values for all of the observations in the data that we used to estimate the original model. If we include this argument, we need to provide a <code>data.frame</code> which has a variable with the same name as the independent variable in our model. Here, we specify <code>newdata = data.frame(PctNotHSGrad = 10)</code>, as we would like the fitted value for a community where 10% of adults did not complete high-school.</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(model1, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">PctNotHSGrad =</span> <span class="dv">10</span>))</code></pre>
<pre><code>       1 
15.31906 </code></pre>
<p>This is the same as the result we obtained when we calculated the fitted value manually. The good thing about the <code>predict()</code> function, however, is that we will be able to use it for <em>all</em> the models we study on this course, and it can be useful for calculating many different fitted values.</p>
</div>
<div id="additional-resources" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Additional Resources</h3>
<ul>
<li><a href="http://altaf.shinyapps.io/linear-regression">Linear Regression - Interactive App</a></li>
</ul>
</div>
<div id="multiple-linear-regression-models" class="section level3">
<h3><span class="header-section-number">9.1.4</span> Multiple linear regression models</h3>
<p>we load the full standard (cross-sectional) dataset from the Quality of Government Institute (this is a newer version that the one we used earlier). This is a great data source for comparativist research. The codebook is available from their main <a href="http://qog.pol.gu.se/data/datadownloads/qogstandarddata">website</a>. You can also find time-series and cross-section data sets on this page.</p>
<p>The dataset is in csv format (<code>.csv</code>). Loading it requires the <code>read.csv()</code> function. Let’s load the data set.</p>
<pre class="sourceCode r"><code class="sourceCode r">world_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://uclspp.github.io/datasets/data/qog_std_cs_jan15.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre>
<p>Check the dimensions of the dataset</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(world_data)</code></pre>
<pre><code>[1]  193 2037</code></pre>
<p>The dataset contains 2037 variables but we’re only interested in the following:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">wbgi_pse</td>
<td align="left">A measure of political stability (larger values mean more stability)</td>
</tr>
<tr class="even">
<td align="left">lp_lat_abst</td>
<td align="left">Distance to the equator or latitude</td>
</tr>
<tr class="odd">
<td align="left">dr_ing</td>
<td align="left">Index for the level of globalization</td>
</tr>
<tr class="even">
<td align="left">ti_cpi</td>
<td align="left">Transparency International’s Corruptions Perceptions Index (larger values mean better quality institutions, i.e. less corruption)</td>
</tr>
<tr class="odd">
<td align="left">br_dem</td>
<td align="left">Factor variable stating whether the country is a democracy or not (with labels <code>1. Democracy</code> and <code>0. Dictatorship</code>)</td>
</tr>
</tbody>
</table>
<p>Our dependent variable (also called response or outcome variable) is <code>wbgi_pse</code>. We will rename the variables we care about to something meaningful.</p>
<p>CAUTION: When renaming variables, do not use spaces or special characters in the name. You can, however, use a period (<code>.</code>) or underscore (<code>_</code>) to make the names more readable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data) <span class="op">==</span><span class="st"> &quot;cname&quot;</span>] &lt;-<span class="st"> &quot;country&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data) <span class="op">==</span><span class="st"> &quot;wbgi_pse&quot;</span>] &lt;-<span class="st"> &quot;pol_stability&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data) <span class="op">==</span><span class="st"> &quot;lp_lat_abst&quot;</span>] &lt;-<span class="st"> &quot;latitude&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data) <span class="op">==</span><span class="st"> &quot;dr_ig&quot;</span>] &lt;-<span class="st"> &quot;globalization&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data) <span class="op">==</span><span class="st"> &quot;chga_demo&quot;</span>] &lt;-<span class="st"> &quot;democracy&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data) <span class="op">==</span><span class="st"> &quot;ti_cpi&quot;</span>] &lt;-<span class="st"> &quot;inst_quality&quot;</span></code></pre>
<p>Now Let’s look at some of these variables using the <code>summary()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(world_data<span class="op">$</span>pol_stability)</code></pre>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-3.10637 -0.72686 -0.01900 -0.06079  0.78486  1.57240 </code></pre>
<p>If you think about political stability, and how one could measure it, you know there is an order implicit in the measurement – more or less stability. From there, what you need to know is whether the more or less is ordinal or interval scaled. Checking <code>pol_stability</code> you see a range from roughly -3 to 1.6. The variable is numerical and has decimal places. This tells you that the variable is at least interval scaled. You will not see ordinally scaled variables with decimal places. Examine the summaries of the other variables and determine their level of measurement.</p>
<p>Now let’s look at the variables that we think can explain political stability. We can use the <code>summary()</code> function on more than one variable by combining their names in a vector.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(world_data[<span class="kw">c</span>(<span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;globalization&#39;</span>, <span class="st">&#39;inst_quality&#39;</span>, <span class="st">&#39;democracy&#39;</span>)])</code></pre>
<pre><code>    latitude      globalization    inst_quality    democracy        
 Min.   :0.0000   Min.   :24.35   Min.   :1.010   Length:193        
 1st Qu.:0.1444   1st Qu.:45.22   1st Qu.:2.400   Class :character  
 Median :0.2444   Median :54.99   Median :3.300   Mode  :character  
 Mean   :0.2865   Mean   :57.15   Mean   :3.988                     
 3rd Qu.:0.4444   3rd Qu.:68.34   3rd Qu.:5.100                     
 Max.   :0.7222   Max.   :92.30   Max.   :9.300                     
 NA&#39;s   :12       NA&#39;s   :12      NA&#39;s   :12                        </code></pre>
<p>The variables <code>latitude</code>, <code>globalization</code> and <code>inst_quality</code> have 12 missing values each marked as <code>NA</code>. <code>democracy</code> has 1 missing value. Missing values could cause trouble because operations including an <code>NA</code> will produce <code>NA</code> as a result (e.g.: <code>1 + NA = NA</code>). We will drop these missing values from our data set using the <code>is.na()</code> function and square brackets. The exlamation mark in front of <code>is.na()</code> means “not”. So, we keep all rows that are not NA’s on the variable <code>latitude</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>latitude), ]</code></pre>
<p>Generally, we want to make sure we drop missing values only from variables that we care about. Now that you have seen how to do this, drop missings from <code>globalization</code>, <code>inst_quality</code>, and <code>democracy</code> yourself.</p>
<pre class="sourceCode r collapsible"><code class="sourceCode r">world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>globalization), ]
world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>inst_quality), ]
world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>democracy), ]</code></pre>
<p>Let’s check the range of the variable <code>latitude</code> from our summary above. It is between <code>0</code> and <code>1</code>. The codebook clarifies that the latitude of a country’s capital has been divided by <code>90</code> to get a variable that ranges from <code>0</code> to <code>1</code>. This would make interpretation difficult. When interpreting the effect of such a variable a unit change (a change of <code>1</code>) covers the entire range or put differently, it is a change from a country at the equator to a country at one of the poles.</p>
<p><img src="img/latitude.png" width="280"></p>
<p>We therefore multiply by <code>90</code> again. This will turn the units of the <code>latitude</code> variable into degrees again which makes interpretation easier.</p>
<pre class="sourceCode r"><code class="sourceCode r">world_data<span class="op">$</span>latitude &lt;-<span class="st"> </span>world_data<span class="op">$</span>latitude <span class="op">*</span><span class="st"> </span><span class="dv">90</span></code></pre>
</div>
<div id="estimating-a-bivariate-regression" class="section level3">
<h3><span class="header-section-number">9.1.5</span> Estimating a Bivariate Regression</h3>
<p>Is there a correlation between the distance of a country to the equator and the level of political stability? Both political stability (dependent variable) and distance to the equator (independent variable) are continuous. Therefore, we will get an idea about the relationship using a scatter plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x =</span> world_data<span class="op">$</span>latitude,
     <span class="dt">y =</span> world_data<span class="op">$</span>pol_stability, 
     <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
     <span class="dt">pch =</span> <span class="dv">20</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;Latitude&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Political Stability&quot;</span>)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>Looking at the cloud of points suggests that there might be a positive relationship: increases in our independent variable <code>latitude</code> appear to be associated with increases in the dependent variable <code>pol_stability</code> (the further from the equator, the more stable).</p>
<p>We can fit a line of best fit through the points. To do this we must estimate the bivariate regression model with the <code>lm()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">latitude_model &lt;-<span class="st"> </span><span class="kw">lm</span>(pol_stability <span class="op">~</span><span class="st"> </span>latitude, <span class="dt">data =</span> world_data)</code></pre>
<p>Now we can create a scatterplot with a regression line using the <code>abline()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x =</span> world_data<span class="op">$</span>latitude,
     <span class="dt">y =</span> world_data<span class="op">$</span>pol_stability,
     <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
     <span class="dt">pch =</span> <span class="dv">20</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;Latitude&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Political Stability&quot;</span>)

<span class="kw">abline</span>(latitude_model, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>We can also view a simple summary of the regression by using the <code>screenreg</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(latitude_model)</code></pre>
<pre><code>
=======================
             Model 1   
-----------------------
(Intercept)   -0.58 ***
              (0.12)   
latitude       0.02 ***
              (0.00)   
-----------------------
R^2            0.11    
Adj. R^2       0.10    
Num. obs.    170       
RMSE           0.89    
=======================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>Thinking back to earlier today, how do we interpret this regression?</p>
<ul>
<li>The coefficient for the variable <code>latitude</code> (<span class="math inline">\(\beta_1\)</span>) indicates that a one-unit increase in a country’s latitude is associated with a 0.0178378 increase in the measure of political stability, on average. Question: Is this association statistically significant at the 95% confidence level?</li>
<li>The coefficient for the <code>(intercept)</code> term (<span class="math inline">\(\beta_0\)</span>) indicates that the average level of political stability for a country with a latitude of 0 is -0.580075 (where <code>latitude = 0</code> is a country positioned at the equator)</li>
<li>The <span class="math inline">\(R^2\)</span> of the model is 0.1065267. This implies that 11% of the variation in the dependent variable (political stability) is explained by the independent variable (latitude) in the model.</li>
</ul>
<p>The regression above suggests that there is a significant association between these variables However, as good social scientistis, we probably do not think that the distance of a country from the equator is a theoretically relevant variable for explaining political stability. This is because there is no plausible causal link between the two. We should therefore consider other variables to include in our model.</p>
<p>We will include the index of globalization (higher values mean more integration with the rest of the world), the quality of institutions, and the indicator for whether the country is a democracy. For all of these variables we can come up with a theoretical story for their effect on political stability.</p>
<p>To specify a <em>multiple</em> linear regression model, the only thing we need to change is the <code>formula</code> argument of the <code>lm()</code> function. In particular, if we wish to add additional explanatory variables, the formula argument will take the following form:</p>
<pre class="sourceCode r"><code class="sourceCode r">dependent.var <span class="op">~</span><span class="st"> </span>independent.var<span class="fl">.1</span> <span class="op">+</span><span class="st"> </span>independent.var<span class="fl">.2</span> <span class="op">+</span><span class="st"> </span>independent.var<span class="fl">.3</span> ...</code></pre>
<p>In our example here, the model would therefore look like the following:</p>
<pre class="sourceCode r"><code class="sourceCode r">inst_model &lt;-<span class="st"> </span><span class="kw">lm</span>(
  pol_stability <span class="op">~</span><span class="st"> </span>latitude <span class="op">+</span><span class="st"> </span>globalization <span class="op">+</span><span class="st"> </span>inst_quality <span class="op">+</span><span class="st"> </span>democracy, 
  <span class="dt">data =</span> world_data
)</code></pre>
<p>Remember, <code>pol_stability</code> is our dependent variable, as before, and now we have four independent variables: <code>latitude</code>, <code>globalization</code>, <code>democracy</code> and <code>inst_quality</code>. Again, just as with the bivariate model, we can view the summarised output of the regression by using <code>screenreg()</code>. As we now have two models (a simple regression model, and a multiple regression model), we can join them together using the <code>list()</code> function, and then put all of that inside <code>screenreg()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(<span class="kw">list</span>(latitude_model, inst_model))</code></pre>
<pre><code>
=============================================
                       Model 1     Model 2   
---------------------------------------------
(Intercept)             -0.58 ***   -1.25 ***
                        (0.12)      (0.20)   
latitude                 0.02 ***    0.00    
                        (0.00)      (0.00)   
globalization                       -0.00    
                                    (0.01)   
inst_quality                         0.34 ***
                                    (0.04)   
democracy1. Democracy                0.04    
                                    (0.11)   
---------------------------------------------
R^2                      0.11        0.50    
Adj. R^2                 0.10        0.49    
Num. obs.              170         170       
RMSE                     0.89        0.67    
=============================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>Including the two new predictors leads to substantial changes.</p>
<ul>
<li>First, we now explain 50% of the variance of our dependent variable instead of just 11%.</li>
<li>Second, the effect of the distance to the equator is no longer significant.</li>
<li>Third, better quality institutions are associated with more political stability. In particular, a one-unit increase in the measure of instituion quality (which ranges from 1 to 10) is associated with a 0.338882 increase in the measure for political stability.</li>
<li>Fourth, there is no significant relationship between globalization and political stability in this data.</li>
<li>Fifth, there is no significant relationship between democracy and political stability in this data.</li>
</ul>
<p>### Predicting outcome conditional on institutional quality</p>
<p>Just as we did with the simple regression model last week, we can use the fitted model object to calculate the fitted values of our dependent variable for different values of our explanatory variables. To do so, we again use the <code>predict()</code> function.</p>
<p>We proceed in three steps.</p>
<ol style="list-style-type: decimal">
<li>We set the values of the covariates for which we would like to produce fitted values.
<ul>
<li>You will need to set covariate values for <em>every</em> explanatory variable that you included in your model.</li>
<li>As only one of our variables has a significant relationship with the outcome in the multiple regression model that we estimated above, we are really only interested in that variable (<code>inst_quality</code>).</li>
<li>Therefore, we will calculate fitted values over the range of <code>inst_quality</code>, while setting the values of <code>latitude</code> and <code>globalization</code> to their mean values.</li>
<li>As <code>democracy</code> is a factor variable, we cannot use the mean value. Instead, we will set <code>democracy</code> to be equal to <code>"1. Democracy"</code> which is the label for democratic countries</li>
</ul></li>
<li>We calculate the fitted values.</li>
<li>We report the results (here we will produce a plot).</li>
</ol>
<p>For step one, the following code produces a <code>data.frame</code> of new covariate values for which we would like to calculate a fitted value from our model:</p>
<pre class="sourceCode r"><code class="sourceCode r">democracies &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">inst_quality =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">1.4</span>, <span class="dt">to =</span> <span class="fl">9.3</span>, <span class="dt">by =</span> <span class="dv">1</span>),
  <span class="dt">globalization =</span> <span class="kw">mean</span>(world_data<span class="op">$</span>globalization),
  <span class="dt">latitude =</span> <span class="kw">mean</span>(world_data<span class="op">$</span>latitude),
  <span class="dt">democracy =</span> <span class="st">&quot;1. Democracy&quot;</span>
)</code></pre>
<p>We’ve just created a <code>data.frame</code> of hypothetical democracies with varying level of institutional quality. Let’s see what this <code>data.frame</code> looks like.</p>
<pre class="sourceCode r"><code class="sourceCode r">democracies</code></pre>
<pre><code>  inst_quality globalization latitude    democracy
1          1.4      57.93053 25.78218 1. Democracy
2          2.4      57.93053 25.78218 1. Democracy
3          3.4      57.93053 25.78218 1. Democracy
4          4.4      57.93053 25.78218 1. Democracy
5          5.4      57.93053 25.78218 1. Democracy
6          6.4      57.93053 25.78218 1. Democracy
7          7.4      57.93053 25.78218 1. Democracy
8          8.4      57.93053 25.78218 1. Democracy</code></pre>
<p>In this <code>data.frame</code>, we have set the <code>inst_quality</code> variable to vary between 1.4 and 9.3000002, with increments of 1 unit which represents the range of <code>inst_quality</code> in our dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(world_data<span class="op">$</span>inst_quality)</code></pre>
<pre><code>[1] 1.4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(world_data<span class="op">$</span>inst_quality)</code></pre>
<pre><code>[1] 9.3</code></pre>
<p>We have set <code>globalization</code> to be equal to the mean value of <code>globalization</code> in the <code>world_data</code> object, and <code>latitude</code> to be equal to the mean value of <code>latitude</code> in the <code>world_data</code> object. Finally, we have set <code>democracy</code> to be equal to <code>"1. Democracy"</code> (the value for democratic countries).</p>
<p>We can now calculate the fitted values for each of these combinations of our explanatory variables using the <code>predict()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">democracies<span class="op">$</span>predicted_pol_stability &lt;-<span class="st"> </span><span class="kw">predict</span>(inst_model, <span class="dt">newdata =</span> democracies)</code></pre>
<p>We can now look again at the <code>democracies</code> object:</p>
<pre class="sourceCode r"><code class="sourceCode r">democracies</code></pre>
<pre><code>  inst_quality globalization latitude    democracy predicted_pol_stability
1          1.4      57.93053 25.78218 1. Democracy             -1.00319887
2          2.4      57.93053 25.78218 1. Democracy             -0.66431685
3          3.4      57.93053 25.78218 1. Democracy             -0.32543483
4          4.4      57.93053 25.78218 1. Democracy              0.01344719
5          5.4      57.93053 25.78218 1. Democracy              0.35232921
6          6.4      57.93053 25.78218 1. Democracy              0.69121123
7          7.4      57.93053 25.78218 1. Democracy              1.03009325
8          8.4      57.93053 25.78218 1. Democracy              1.36897527</code></pre>
<p>Hey presto! Now, for each of our explanatory variable combinations, we have the corresponding fitted values as calculated from our estimated regression.</p>
<p>Finally, we can plot these values:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> democracies<span class="op">$</span>inst_quality,
  <span class="dt">y =</span> democracies<span class="op">$</span>predicted_pol_stability,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, 
  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Institution Quality&quot;</span>, 
  <span class="dt">ylab =</span> <span class="st">&quot;Fitted value for political stability&quot;</span>
)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p>We could also use the output from our model to plot two separate lines of fitted values: one for democracies, and one for dictatorships. We have already done this for democracies, so the following code constructs a <code>data.frame</code> of fitted values for dictatorships:</p>
<pre class="sourceCode r"><code class="sourceCode r">dictatorships &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">inst_quality =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">1.4</span>, <span class="dt">to =</span> <span class="fl">9.3</span>, <span class="dt">by =</span> <span class="dv">1</span>),
  <span class="dt">globalization =</span> <span class="kw">mean</span>(world_data<span class="op">$</span>globalization),
  <span class="dt">latitude =</span> <span class="kw">mean</span>(world_data<span class="op">$</span>latitude),
  <span class="dt">democracy =</span> <span class="st">&quot;0. Dictatorship&quot;</span>
)

dictatorships<span class="op">$</span>predicted_pol_stability &lt;-<span class="st"> </span><span class="kw">predict</span>(inst_model, <span class="dt">newdata =</span> dictatorships)</code></pre>
<p>Now that we have calculated these fitted values, we can add the line for dictatorships to the plot we created above using the <code>lines()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> democracies<span class="op">$</span>inst_quality,
  <span class="dt">y =</span> democracies<span class="op">$</span>predicted_pol_stability,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, 
  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Institution Quality&quot;</span>, 
  <span class="dt">ylab =</span> <span class="st">&quot;Fitted value for political stability&quot;</span>
)

<span class="kw">lines</span>(<span class="dt">x =</span> dictatorships<span class="op">$</span>inst_quality,
      <span class="dt">y =</span> dictatorships<span class="op">$</span>predicted_pol_stability,
      <span class="dt">data =</span> dictatorships,
      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<pre><code>Warning in plot.xy(xy.coords(x, y), type = type, ...): &quot;data&quot; is not a
graphical parameter</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>We can see from the plot that the fitted values for democracies (blue line) are almost exactly the same as those for dictatorships (red line). This is reassuring, as the estimated coefficient on the democracy variable was very small (0.04) and was not statistically significantly different from 0. Often, however, it can be very illuminating to construct plots like this where we construct a line to indicate how our predicted values for Y vary across one of our explanatory variables (here, institution quality), and we create different lines for different values of another explanatory variable (here, democracy/dictatorship).</p>
</div>
<div id="non-linearities" class="section level3">
<h3><span class="header-section-number">9.1.6</span> Non-Linearities</h3>
<p>Let’s clear our workspace for now to keep the workspace tidy and to prevent our computer from slowing down.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre>
<p>We will use the small version of the Quality of Government data from 2012 again (<code>QoG2012.csv</code>) with four variables:</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>former_col</code></td>
<td>0 = not a former colony <br> 1 = former colony</td>
</tr>
<tr class="even">
<td><code>undp_hdi</code></td>
<td>UNDP Human Development Index. Higher values mean better quality of life</td>
</tr>
<tr class="odd">
<td><code>wbgi_cce</code></td>
<td>Control of corruption. Higher values mean better control of corruption</td>
</tr>
<tr class="even">
<td><code>wdi_gdpc</code></td>
<td>GDP per capita in US dollars</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">world_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;QoG2012.csv&quot;</span>)
<span class="kw">names</span>(world_data)</code></pre>
<pre><code>[1] &quot;h_j&quot;         &quot;wdi_gdpc&quot;    &quot;undp_hdi&quot;    &quot;wbgi_cce&quot;    &quot;wbgi_pse&quot;   
[6] &quot;former_col&quot;  &quot;lp_lat_abst&quot;</code></pre>
<p>Rename the variables by yourself to:</p>
<table>
<thead>
<tr class="header">
<th>New Name</th>
<th>Old Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>human_development</code></td>
<td><code>undp_hdi</code></td>
</tr>
<tr class="even">
<td><code>institutions_quality</code></td>
<td><code>wbgi_cce</code></td>
</tr>
<tr class="odd">
<td><code>gdp_capita</code></td>
<td><code>wdi_gdpc</code></td>
</tr>
</tbody>
</table>
<pre class="sourceCode r collapsible"><code class="sourceCode r"><span class="kw">names</span>(world_data)</code></pre>
<pre><code>[1] &quot;h_j&quot;         &quot;wdi_gdpc&quot;    &quot;undp_hdi&quot;    &quot;wbgi_cce&quot;    &quot;wbgi_pse&quot;   
[6] &quot;former_col&quot;  &quot;lp_lat_abst&quot;</code></pre>
<pre class="sourceCode r collapsible"><code class="sourceCode r"><span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data)<span class="op">==</span><span class="st">&quot;undp_hdi&quot;</span>] &lt;-<span class="st"> &quot;human_development&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data)<span class="op">==</span><span class="st">&quot;wbgi_cce&quot;</span>] &lt;-<span class="st"> &quot;institutions_quality&quot;</span>
<span class="kw">names</span>(world_data)[<span class="kw">names</span>(world_data)<span class="op">==</span><span class="st">&quot;wdi_gdpc&quot;</span>] &lt;-<span class="st"> &quot;gdp_capita&quot;</span>
<span class="kw">names</span>(world_data)</code></pre>
<pre><code>[1] &quot;h_j&quot;                  &quot;gdp_capita&quot;           &quot;human_development&quot;   
[4] &quot;institutions_quality&quot; &quot;wbgi_pse&quot;             &quot;former_col&quot;          
[7] &quot;lp_lat_abst&quot;         </code></pre>
<p>Now let’s look at the summary statistics for the entire data set.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(world_data) </code></pre>
<pre><code>      h_j           gdp_capita      human_development institutions_quality
 Min.   :0.0000   Min.   :  226.2   Min.   :0.2730    Min.   :-1.69953    
 1st Qu.:0.0000   1st Qu.: 1768.0   1st Qu.:0.5390    1st Qu.:-0.81965    
 Median :0.0000   Median : 5326.1   Median :0.7510    Median :-0.30476    
 Mean   :0.3787   Mean   :10184.1   Mean   :0.6982    Mean   :-0.05072    
 3rd Qu.:1.0000   3rd Qu.:12976.5   3rd Qu.:0.8335    3rd Qu.: 0.50649    
 Max.   :1.0000   Max.   :63686.7   Max.   :0.9560    Max.   : 2.44565    
 NA&#39;s   :25       NA&#39;s   :16        NA&#39;s   :19        NA&#39;s   :2           
    wbgi_pse          former_col      lp_lat_abst    
 Min.   :-2.46746   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:-0.72900   1st Qu.:0.0000   1st Qu.:0.1343  
 Median : 0.02772   Median :1.0000   Median :0.2444  
 Mean   :-0.03957   Mean   :0.6289   Mean   :0.2829  
 3rd Qu.: 0.79847   3rd Qu.:1.0000   3rd Qu.:0.4444  
 Max.   : 1.67561   Max.   :1.0000   Max.   :0.7222  
                                     NA&#39;s   :7       </code></pre>
<p>We need to remove missing values from <code>gdp_capita</code>, <code>human_development</code>, and <code>institutions_quality</code>. Do so yourself. Do not drop observations that missing values on other observations such as <code>lp_lat_abst</code>. We might throw away useful information when doing so.</p>
<pre class="sourceCode r collapsible"><code class="sourceCode r">world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>gdp_capita), ]
world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>human_development), ]
world_data &lt;-<span class="st"> </span>world_data[ <span class="op">!</span><span class="kw">is.na</span>(world_data<span class="op">$</span>institutions_quality), ]</code></pre>
<p>Let’s suppose we want to illustrate the relationship between GDP per capita and the human development index. We draw a scatter plot to investigate the relationship between the quality of life (hdi) and wealth (gdp/captia).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> world_data<span class="op">$</span>gdp_capita,
  <span class="dt">y =</span> world_data<span class="op">$</span>human_development,
  <span class="dt">data =</span> world_data,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Relationship between the quality of life and wealth&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Human development index&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;GDP per capita&quot;</span>
)</code></pre>
<pre><code>Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter

Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter</code></pre>
<pre><code>Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
<p>It’s easy to see, that the relationship between GDP per captia and the Human Development Index is not linear. Increases in wealth rapidly increase the quality of life in poor societies. The richer the country, the less pronounced the effect of additional wealth. We would mis-specify our model if we do not take the non-linear relationship into account.</p>
<p>Let’s go ahead and fit a mis-specified model:</p>
<pre class="sourceCode r"><code class="sourceCode r">linear.model &lt;-<span class="st"> </span><span class="kw">lm</span>(human_development <span class="op">~</span><span class="st"> </span>gdp_capita, <span class="dt">data =</span> world_data)
<span class="kw">screenreg</span>(linear.model)</code></pre>
<pre><code>
=======================
             Model 1   
-----------------------
(Intercept)    0.59 ***
              (0.01)   
gdp_capita     0.00 ***
              (0.00)   
-----------------------
R^2            0.49    
Adj. R^2       0.49    
Num. obs.    172       
RMSE           0.13    
=======================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>We detect a significant linear relationship. The effect may look small because the coefficient rounded to two digits is zero. But remember, this is the effect of increasing GDP/capita by <span class="math inline">\(1\)</span> US dollar on the quality of life. That effect is naturally small but it is probably not small when we increase wealth by <span class="math inline">\(1000\)</span> US dollars.</p>
<p>However, our model would also entail that for every increase in GDP/capita, the quality of life increases on average by the same amount. We saw from our plot that this is not the case. The effect of GDP/capita on the quality of life is conditional on the level of GDP/capita. If that sounds like an interaction to you, then that is great because, we will model the non-linearity by raising the GDP/capita to a higher power. That is in effect an interaction of the variable with itself. GDP/capita raised to the second power, e.g. is GDP/capita * GDP/capita.</p>
<div id="polynomials" class="section level4">
<h4><span class="header-section-number">9.1.6.1</span> Polynomials</h4>
<p>We know from school that polynomials like <span class="math inline">\(X^2\)</span>, <span class="math inline">\(X^3\)</span> and so on are not linear. The relationship depicted in our plot above suggests a quadratic relationship between GDP per capita and the human development index might be appropriate (there is only one obvious “bend” in the data). To incorporate this intuition into our model, we will use the <code>poly()</code> function in our linear model to raise GDP/capita to the second power like so: <code>poly(gdp_capita, degree = 2).</code></p>
<pre class="sourceCode r"><code class="sourceCode r">quadratic.model &lt;-<span class="st"> </span><span class="kw">lm</span>(
  human_development <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(gdp_capita, <span class="dt">degree =</span> <span class="dv">2</span>), 
  <span class="dt">data =</span> world_data
)


<span class="kw">screenreg</span>(
  <span class="kw">list</span>(linear.model, quadratic.model), 
  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Linear model&quot;</span>, <span class="st">&quot;Quadratic model&quot;</span>)
)</code></pre>
<pre><code>
============================================================
                               Linear model  Quadratic model
------------------------------------------------------------
(Intercept)                      0.59 ***      0.70 ***     
                                (0.01)        (0.01)        
gdp_capita                       0.00 ***                   
                                (0.00)                      
poly(gdp_capita, degree = 2)1                  1.66 ***     
                                              (0.10)        
poly(gdp_capita, degree = 2)2                 -1.00 ***     
                                              (0.10)        
------------------------------------------------------------
R^2                              0.49          0.67         
Adj. R^2                         0.49          0.66         
Num. obs.                      172           172            
RMSE                             0.13          0.10         
============================================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>It is important to note, that in the quadratic model the effect of GDP/capita is no longer easy to interpret. We cannot say for every increase in GDP/capita by one dollar, the quality of life increases on average by some fixed amount. This is because the effect of GDP/capita depends on how rich a country was to begin with. We can, however, interpret the statitical significance of the quadratic term: the coefficient is about 10 times as large in absolute terms as the standard error, meaning we can easily reject the null hypothesis that the relationship between GDP and the HDI is linear. Furthermore, it looks like our model that includes the quadratic term has a much better fit, as the adjusted <span class="math inline">\(R^2\)</span> has increased by a lot.</p>
<p>We can interpret the effect of wealth (GDP/capita) on the quality of life (human development index) by predicting the fitted values of the human development index given a certain level of GDP/capita. We will vary GDP/captia from its minimum in the data to its maximum and the plot the results which is a good way to illustrate a non-linear relationship.</p>
<p>Step 1: We find the minimum and maximum values of GDP/capita.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(world_data<span class="op">$</span>gdp_capita)</code></pre>
<pre><code>[1]   226.235 63686.676</code></pre>
<p>Step 2: We predict fitted values for varying levels of GDP/captia (let’s create 100 predictions).</p>
<p>We create our sequence of 100 GDP/capita values</p>
<pre class="sourceCode r"><code class="sourceCode r">gdp_seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">226</span>, <span class="dt">to =</span> <span class="dv">63686</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</code></pre>
<p>We set our covariate values (here we only have one covariate: GDP/captia)</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gdp_capita =</span> gdp_seq)</code></pre>
<p>We predict the outcome (human development index) for each of the 100 GDP levels</p>
<pre class="sourceCode r"><code class="sourceCode r">y_hat &lt;-<span class="st"> </span><span class="kw">predict</span>(quadratic.model, <span class="dt">newdata =</span> x)</code></pre>
<p>Step 3: Now that we have created our predictions. We plot again and then we add the <code>linear.model</code> using <code>abline</code> and we add our non-linear version <code>quadratic.model</code> using the <code>lines()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> world_data<span class="op">$</span>gdp_capita,
  <span class="dt">y =</span> world_data<span class="op">$</span>human_development,
  <span class="dt">data =</span> world_data,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Relationship between the quality of life and wealth&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Human development index&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;GDP per capita&quot;</span>
)</code></pre>
<pre><code>Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter

Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter</code></pre>
<pre><code>Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the linear model</span>
<span class="kw">abline</span>(linear.model, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)

<span class="co"># better model</span>
<span class="kw">lines</span>(<span class="dt">x =</span> gdp_seq, <span class="dt">y =</span> y_hat, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<p>We could go further than this quadratic specification, and instead estimate a <code>cubic.model</code> with GDP/capita raised to the power of three. Do this now and present your results visually.</p>
<p>Estimate cubic model</p>
<pre class="sourceCode r collapsible"><code class="sourceCode r">cubic.model &lt;-<span class="st"> </span><span class="kw">lm</span>(human_development <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(gdp_capita, <span class="dv">3</span>), <span class="dt">data =</span> world_data)</code></pre>
<p>We predict the outcome (human development index) for each of the 100 GDP levels</p>
<pre class="sourceCode r"><code class="sourceCode r">y_hat2 &lt;-<span class="st"> </span><span class="kw">predict</span>(cubic.model, <span class="dt">newdata =</span> x)</code></pre>
<p>Next, we plot the linear and quadratic models</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> world_data<span class="op">$</span>gdp_capita,
  <span class="dt">y =</span> world_data<span class="op">$</span>human_development,
  <span class="dt">data =</span> world_data,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Relationship between the quality of life and wealth&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Human development index&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;GDP per capita&quot;</span>
  )</code></pre>
<pre><code>Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter

Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter</code></pre>
<pre><code>Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the linear model</span>
<span class="kw">abline</span>(linear.model, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)

<span class="co"># quadratic model</span>
<span class="kw">lines</span>(<span class="dt">x =</span> gdp_seq, <span class="dt">y =</span> y_hat, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)

<span class="co"># cubic model</span>
<span class="kw">lines</span>(<span class="dt">x =</span> gdp_seq, <span class="dt">y =</span> y_hat2, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<p>The cubic model provides a similar story to the quadratic model (the relationship between GDP/capita and HDI is steep at first, and then flatter at the higher levels of GDP/captia), but it looks somewhat strange, particularly at the higher levels of GDP/capita. In particular, it seems that the few extreme X values are causing a strange shape: the cubic is being wagged around by its tail. This is a common problem with polynomial regression models, and so we will now consider an alternative.</p>
</div>
<div id="log-transformations" class="section level4">
<h4><span class="header-section-number">9.1.6.2</span> Log-transformations</h4>
<p>Many non-linear relationships actually do look linear on the log scale. We can illustrate this by taking the natural logarithm of GDP/captia and plot the relationship between quality of life and our transformed GDP variable.</p>
<p>Note: Some of you will remember from your school calculators that you have an ln button and a log button where ln takes the natural logarithm and log takes the logarithm with base 10. The natural logarithm represents relations that occur frequently in the world and R takes the natural logarithm with the <code>log()</code> function by default.</p>
<p>Below, we plot the same plot from before but we wrap <code>gdp_capita</code> in the <code>log()</code> function which log-transforms the variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> <span class="kw">log</span>(world_data<span class="op">$</span>gdp_capita),
  <span class="dt">y =</span> world_data<span class="op">$</span>human_development,
  <span class="dt">data =</span> world_data,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Relationship between the quality of life and wealth on the log scale&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Human development index&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Logged gdp/capita&quot;</span>
  )</code></pre>
<pre><code>Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter

Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter</code></pre>
<pre><code>Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<p>As you can see, the relationship now looks much closer to linear and we get the best fit to the data (as measured by adjusted <span class="math inline">\(R^2\)</span>) if we run our model with log-transformed gdp.</p>
<pre class="sourceCode r"><code class="sourceCode r">log.model &lt;-<span class="st"> </span><span class="kw">lm</span>(human_development <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(gdp_capita), <span class="dt">data =</span> world_data)</code></pre>
<p>Let’s check our model</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(
  <span class="kw">list</span>(linear.model, quadratic.model, cubic.model, log.model),
  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Linear Model&quot;</span>, <span class="st">&quot;Quadratic Model&quot;</span>, <span class="st">&quot;Cubic Model&quot;</span>, <span class="st">&quot;Log Model&quot;</span>)
)</code></pre>
<pre><code>
=====================================================================================
                               Linear Model  Quadratic Model  Cubic Model  Log Model 
-------------------------------------------------------------------------------------
(Intercept)                      0.59 ***      0.70 ***         0.70 ***    -0.36 ***
                                (0.01)        (0.01)           (0.01)       (0.04)   
gdp_capita                       0.00 ***                                            
                                (0.00)                                               
poly(gdp_capita, degree = 2)1                  1.66 ***                              
                                              (0.10)                                 
poly(gdp_capita, degree = 2)2                 -1.00 ***                              
                                              (0.10)                                 
poly(gdp_capita, 3)1                                            1.66 ***             
                                                               (0.09)                
poly(gdp_capita, 3)2                                           -1.00 ***             
                                                               (0.09)                
poly(gdp_capita, 3)3                                            0.65 ***             
                                                               (0.09)                
log(gdp_capita)                                                              0.12 ***
                                                                            (0.00)   
-------------------------------------------------------------------------------------
R^2                              0.49          0.67             0.74         0.81    
Adj. R^2                         0.49          0.66             0.74         0.81    
Num. obs.                      172           172              172          172       
RMSE                             0.13          0.10             0.09         0.08    
=====================================================================================
*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<p>Polynomials can be useful for modelling non-linearities. However, for each additional polynomial term we add, we also add an additional parameter that needs to be estimated. This reduces the degrees of freedom of the model. If we can get a linear relationship on the log scale, one advantage is that we use the same number of parameters as in the original linear model.</p>
<p>Furthermore, we gain interpretability. The relationship is linear on the log scale of gdp/capita. This means we can interpret the effect of gdp/captia as: For an increase of gdp/captia by one percent, the quality of life increases by <span class="math inline">\(\frac{\hat{\beta}}{100} = \frac{0.12}{100}\)</span> points on average. The effect is very large because <code>human_development</code> only varies from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span>.</p>
<p>The adjusted <span class="math inline">\(R^2\)</span> also suggests that the log model provides the best fit to the data. To illustrate that this is the case, we return to our plot and show the model fit graphically.</p>
<p>Get the fitted values for the log model.</p>
<pre class="sourceCode r"><code class="sourceCode r">y_hat3 &lt;-<span class="st"> </span><span class="kw">predict</span>(log.model, <span class="dt">newdata =</span> x)</code></pre>
<p>Create a plot showing the fitted values</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x =</span> world_data<span class="op">$</span>gdp_capita,
  <span class="dt">y =</span> world_data<span class="op">$</span>human_development,
  <span class="dt">data =</span> world_data,
  <span class="dt">pch =</span> <span class="dv">20</span>,
  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,
  <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Relationship between the quality of life and wealth&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Human development index&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;GDP per capita&quot;</span>
  )</code></pre>
<pre><code>Warning in plot.window(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in plot.xy(xy, type, ...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter

Warning in axis(side = side, at = at, labels = labels, ...): &quot;data&quot; is not
a graphical parameter</code></pre>
<pre><code>Warning in title(...): &quot;data&quot; is not a graphical parameter</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Linear model</span>
<span class="kw">abline</span>(linear.model, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)

<span class="co"># Quadratic model</span>
<span class="kw">lines</span>(<span class="dt">x =</span> gdp_seq, <span class="dt">y =</span> y_hat, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)

<span class="co"># Cubic model</span>
<span class="kw">lines</span>(<span class="dt">x =</span> gdp_seq, <span class="dt">y =</span> y_hat2, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)

<span class="co"># Log model</span>
<span class="kw">lines</span>(<span class="dt">x =</span> gdp_seq, <span class="dt">y =</span> y_hat3, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)

<span class="co"># Add a legend</span>
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, 
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Cubic&quot;</span>, <span class="st">&quot;Log&quot;</span>), 
       <span class="dt">lty =</span> <span class="dv">1</span>, 
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>) 
)</code></pre>
<p><img src="suffolk2019_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
<p>The blue line shows the log-transformed model. It clearly fits the data best.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="seminar8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="seminar10.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["suffolk2019.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
